<app-header></app-header>

<div class="loan-contract-detail-page">
  <!-- Page Header -->
  <section class="page-header">
    <div class="container">
      <div class="header-content">
        <button type="button" class="back-btn" (click)="goBack()">
          â† Quay láº¡i
        </button>
        <h1>Chi tiáº¿t há»£p Ä‘á»“ng vay</h1>
        <p *ngIf="contract">MÃ£ há»£p Ä‘á»“ng: #{{contract.id}}</p>
      </div>
      <div class="header-actions" *ngIf="contract">
        <span class="status-badge" [class]="getStatusClass(contract.status)">
          {{getStatusLabel(contract.status)}}
        </span>
      </div>
    </div>
  </section>

  <!-- Error Display -->
  <div class="error-container" *ngIf="error">
    <div class="container">
      <div class="alert alert-error">
        {{error}}
        <button type="button" class="close-btn" (click)="error = null">Ã—</button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Äang táº£i thÃ´ng tin há»£p Ä‘á»“ng...</p>
  </div>

  <!-- Contract Details -->
  <section class="contract-details-section" *ngIf="!isLoading && contract">
    <div class="container">
      <div class="details-grid">
        
        <!-- ThÃ´ng tin cÃ¡ nhÃ¢n -->
        <div class="detail-card">
          <div class="card-header">
            <h3>ğŸ“‹ ThÃ´ng tin cÃ¡ nhÃ¢n</h3>
          </div>
          <div class="card-content">
            <div class="info-row">
              <span class="label">Há» vÃ  tÃªn:</span>
              <span class="value">{{contract.name}}</span>
            </div>
            <div class="info-row">
              <span class="label">Email:</span>
              <span class="value">{{contract.email}}</span>
            </div>
            <div class="info-row">
              <span class="label">Sá»‘ Ä‘iá»‡n thoáº¡i:</span>
              <span class="value">{{contract.phone}}</span>
            </div>
            <div class="info-row">
              <span class="label">Äá»‹a chá»‰:</span>
              <span class="value">{{contract.address}}</span>
            </div>
            <div class="info-row" *ngIf="contract.birthDay">
              <span class="label">NgÃ y sinh:</span>
              <span class="value">{{formatDate(contract.birthDay)}}</span>
            </div>
            <div class="info-row" *ngIf="contract.gender">
              <span class="label">Giá»›i tÃ­nh:</span>
              <span class="value">{{contract.gender}}</span>
            </div>
            <div class="info-row" *ngIf="contract.maritalStatus">
              <span class="label">TÃ¬nh tráº¡ng hÃ´n nhÃ¢n:</span>
              <span class="value">{{contract.maritalStatus}}</span>
            </div>
            <div class="info-row">
              <span class="label">Nghá» nghiá»‡p:</span>
              <span class="value">{{contract.job}}</span>
            </div>
            <div class="info-row">
              <span class="label">Thu nháº­p hÃ ng thÃ¡ng:</span>
              <span class="value highlight">{{formatCurrency(contract.salary)}}</span>
            </div>
          </div>
        </div>

        <!-- ThÃ´ng tin gÃ³i vay -->
        <div class="detail-card">
          <div class="card-header">
            <h3>ğŸ“¦ ThÃ´ng tin gÃ³i vay</h3>
          </div>
          <div class="card-content">
            <div class="info-row" *ngIf="contract.loanPackage">
              <span class="label">TÃªn gÃ³i vay:</span>
              <span class="value">{{contract.loanPackage.name}}</span>
            </div>
            <div class="info-row">
              <span class="label">Sá»‘ tiá»n vay:</span>
              <span class="value highlight">{{formatCurrency(contract.loanAmount)}}</span>
            </div>
            <div class="info-row">
              <span class="label">Thá»i háº¡n vay:</span>
              <span class="value">{{contract.loanTerm}} thÃ¡ng</span>
            </div>
            <div class="info-row" *ngIf="contract.interestRate">
              <span class="label">LÃ£i suáº¥t:</span>
              <span class="value">{{contract.interestRate}}%/thÃ¡ng</span>
            </div>
            <div class="info-row" *ngIf="contract.emi">
              <span class="label">Tráº£ hÃ ng thÃ¡ng:</span>
              <span class="value highlight">{{formatCurrency(contract.emi)}}</span>
            </div>
            <div class="info-row" *ngIf="contract.interestAmount">
              <span class="label">Tá»•ng tiá»n lÃ£i:</span>
              <span class="value">{{formatCurrency(contract.interestAmount)}}</span>
            </div>
            <div class="info-row" *ngIf="contract.totalAmount">
              <span class="label">Tá»•ng sá»‘ tiá»n pháº£i tráº£:</span>
              <span class="value highlight">{{formatCurrency(contract.totalAmount)}}</span>
            </div>
          </div>
        </div>

        <!-- ThÃ´ng tin há»£p Ä‘á»“ng -->
        <div class="detail-card">
          <div class="card-header">
            <h3>ğŸ“„ ThÃ´ng tin há»£p Ä‘á»“ng</h3>
          </div>
          <div class="card-content">
            <div class="info-row">
              <span class="label">MÃ£ há»£p Ä‘á»“ng:</span>
              <span class="value">#{{contract.id}}</span>
            </div>
            <div class="info-row">
              <span class="label">Tráº¡ng thÃ¡i:</span>
              <span class="status-badge" [class]="getStatusClass(contract.status)">
                {{getStatusLabel(contract.status)}}
              </span>
            </div>
            <div class="info-row">
              <span class="label">NgÃ y táº¡o:</span>
              <span class="value">{{formatDate(contract.createdAt)}}</span>
            </div>
            <div class="info-row" *ngIf="contract.updatedAt !== contract.createdAt">
              <span class="label">NgÃ y cáº­p nháº­t:</span>
              <span class="value">{{formatDate(contract.updatedAt)}}</span>
            </div>
            <div class="info-row" *ngIf="contract.contractDate">
              <span class="label">NgÃ y kÃ½ há»£p Ä‘á»“ng:</span>
              <span class="value">{{formatDate(contract.contractDate)}}</span>
            </div>
            <div class="info-row" *ngIf="contract.note">
              <span class="label">Ghi chÃº:</span>
              <span class="value">{{contract.note}}</span>
            </div>
          </div>
        </div>

      </div>

      <!-- Action Buttons -->
      <div class="action-section" *ngIf="contract">
        <div class="action-buttons">
          <button 
            type="button"
            class="btn btn-secondary"
            (click)="goBack()">
            â† Quay láº¡i danh sÃ¡ch
          </button>

    
          <button 
            type="button"
            class="btn btn-danger"
            *ngIf="canDelete()"
            (click)="deleteContract()">
            ğŸ—‘ï¸ XÃ³a há»£p Ä‘á»“ng
          </button>
        </div>

        <!-- Status Info -->
        <div class="status-info" *ngIf="contract.status === 'pending'">
          <div class="info-box info-warning">
            <h4>â³ ÄÆ¡n vay Ä‘ang chá» xá»­ lÃ½</h4>
            <p>ÄÆ¡n vay cá»§a báº¡n Ä‘ang Ä‘Æ°á»£c xem xÃ©t. ChÃºng tÃ´i sáº½ liÃªn há»‡ vá»›i báº¡n trong thá»i gian sá»›m nháº¥t.</p>
          </div>
        </div>

        <div class="status-info" *ngIf="contract.status === 'approved'">
          <div class="info-box info-success">
            <h4>âœ… ÄÆ¡n vay Ä‘Ã£ Ä‘Æ°á»£c phÃª duyá»‡t</h4>
            <p>ChÃºc má»«ng! ÄÆ¡n vay cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c phÃª duyá»‡t. Vui lÃ²ng liÃªn há»‡ vá»›i chÃºng tÃ´i Ä‘á»ƒ hoÃ n táº¥t thá»§ tá»¥c.</p>
          </div>
        </div>

        <div class="status-info" *ngIf="contract.status === 'rejected'">
          <div class="info-box info-error">
            <h4>âŒ ÄÆ¡n vay bá»‹ tá»« chá»‘i</h4>
            <p>Ráº¥t tiáº¿c, Ä‘Æ¡n vay cá»§a báº¡n khÃ´ng Ä‘Æ°á»£c phÃª duyá»‡t. Vui lÃ²ng liÃªn há»‡ vá»›i chÃºng tÃ´i Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<app-footer></app-footer>
